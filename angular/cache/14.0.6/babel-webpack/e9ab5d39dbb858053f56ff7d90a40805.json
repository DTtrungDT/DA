{"ast":null,"code":"import _asyncToGenerator from \"D:/Code PJ/SocialNetworkWebApp/SocialNetworkWebApp-FE/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { lastValueFrom } from 'rxjs';\nimport { Chatroom } from 'src/app/models/chatroom.model';\nimport { User } from 'src/app/models/user.model';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/router\";\nimport * as i2 from \"src/app/services/user.service\";\nimport * as i3 from \"src/app/services/friendship.service\";\nimport * as i4 from \"src/app/services/chatroom.service\";\nimport * as i5 from \"src/app/services/chatting.service\";\nexport class RequestsComponent {\n  constructor(elementRef, router, userService, friendshipService, chatroomService, chattingService) {\n    this.elementRef = elementRef;\n    this.router = router;\n    this.userService = userService;\n    this.friendshipService = friendshipService;\n    this.chatroomService = chatroomService;\n    this.chattingService = chattingService;\n    this.user = new User();\n    this.response = '';\n  }\n\n  ngOnInit() {\n    this.getUser();\n  }\n\n  getUser() {\n    this.userService.getById(this.friendshipData.userId).subscribe(data => this.user = data);\n  } // accept(): void {\n  //   this.friendshipData.status = 1;\n  //   this.friendshipService.update(this.friendshipData).subscribe(_ => this.showResponse('accepted'));\n  // }\n\n\n  accept() {\n    var _this = this;\n\n    return _asyncToGenerator(function* () {\n      if (_this.friendshipData.status === 0) {\n        _this.friendshipData.status = 1;\n\n        _this.friendshipService.update(_this.friendshipData).subscribe(data => _this.showResponse('accepted'));\n\n        let chatroom = new Chatroom();\n        chatroom.chatroomName = '';\n        chatroom.id = yield lastValueFrom(_this.chatroomService.add(chatroom));\n        chatroom.chatMembers.push(...[_this.user, _this.currentUser]);\n\n        _this.chatroomService.update(chatroom).subscribe();\n      }\n    })();\n  }\n\n  decline() {\n    this.friendshipService.delete(this.friendshipData.id).subscribe(_ => this.showResponse('declined'));\n  }\n\n  showResponse(result) {\n    const buttons = this.elementRef.nativeElement.querySelector('.action');\n    const responseElm = this.elementRef.nativeElement.querySelector('.response');\n    buttons.style.display = 'none';\n    responseElm.style.display = 'block';\n    this.response = result;\n  }\n\n  navigateToWall() {\n    this.router.navigateByUrl(`home/wall/${this.friendshipData.userId}`);\n  }\n\n}\n\nRequestsComponent.ɵfac = function RequestsComponent_Factory(t) {\n  return new (t || RequestsComponent)(i0.ɵɵdirectiveInject(i0.ElementRef), i0.ɵɵdirectiveInject(i1.Router), i0.ɵɵdirectiveInject(i2.UserService), i0.ɵɵdirectiveInject(i3.FriendshipService), i0.ɵɵdirectiveInject(i4.ChatroomService), i0.ɵɵdirectiveInject(i5.ChattingService));\n};\n\nRequestsComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: RequestsComponent,\n  selectors: [[\"app-requests\"]],\n  inputs: {\n    friendshipData: \"friendshipData\",\n    currentUser: \"currentUser\"\n  },\n  decls: 16,\n  vars: 4,\n  consts: [[1, \"request\"], [1, \"info\"], [1, \"profile-picture\"], [\"alt\", \"\", 3, \"src\", \"click\", \"error\"], [1, \"text-muted\"], [1, \"action\"], [1, \"btn\", \"btn-primary\", 3, \"click\"], [1, \"btn\", 3, \"click\"], [1, \"response\"]],\n  template: function RequestsComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"div\", 0)(1, \"div\", 1)(2, \"div\", 2)(3, \"img\", 3);\n      i0.ɵɵlistener(\"click\", function RequestsComponent_Template_img_click_3_listener() {\n        return ctx.navigateToWall();\n      })(\"error\", function RequestsComponent_Template_img_error_3_listener() {\n        return ctx.user.getDefaultAvatar();\n      });\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(4, \"div\")(5, \"h4\");\n      i0.ɵɵtext(6);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(7, \"p\", 4);\n      i0.ɵɵtext(8);\n      i0.ɵɵelementEnd()()();\n      i0.ɵɵelementStart(9, \"div\", 5)(10, \"button\", 6);\n      i0.ɵɵlistener(\"click\", function RequestsComponent_Template_button_click_10_listener() {\n        return ctx.accept();\n      });\n      i0.ɵɵtext(11, \" Accept \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(12, \"button\", 7);\n      i0.ɵɵlistener(\"click\", function RequestsComponent_Template_button_click_12_listener() {\n        return ctx.decline();\n      });\n      i0.ɵɵtext(13, \" Decline \");\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(14, \"div\", 8);\n      i0.ɵɵtext(15);\n      i0.ɵɵelementEnd()();\n    }\n\n    if (rf & 2) {\n      i0.ɵɵadvance(3);\n      i0.ɵɵproperty(\"src\", ctx.user.getAvatar(), i0.ɵɵsanitizeUrl);\n      i0.ɵɵadvance(3);\n      i0.ɵɵtextInterpolate(ctx.user.getFullName());\n      i0.ɵɵadvance(2);\n      i0.ɵɵtextInterpolate1(\" @\", ctx.user.getEmailPrefix(), \" \");\n      i0.ɵɵadvance(7);\n      i0.ɵɵtextInterpolate1(\" Request has been \", ctx.response, \" \");\n    }\n  },\n  styles: [\"*[_ngcontent-%COMP%], *[_ngcontent-%COMP%]::before, *[_ngcontent-%COMP%]::after {\\r\\n    margin: 0;\\r\\n    padding: 0;\\r\\n    outline: 0;\\r\\n    box-sizing: border-box;\\r\\n    text-decoration: none;\\r\\n    list-style: none;\\r\\n    border: none;\\r\\n\\r\\n    font-family: 'Roboto', sans-serif, Arial, Helvetica;\\r\\n}\\r\\n\\r\\nimg[_ngcontent-%COMP%] {\\r\\n    display: block;\\r\\n    width: 100%;\\r\\n}\\r\\n\\r\\n.btn[_ngcontent-%COMP%] {\\r\\n    display: inline-block;\\r\\n    padding: var(--btn-padding);\\r\\n    font-weight: 500;\\r\\n    border-radius: var(--border-radius);\\r\\n    cursor: pointer;\\r\\n    transition: all 300ms ease;\\r\\n    font-size: 0.9rem;\\r\\n}\\r\\n\\r\\n.btn[_ngcontent-%COMP%]:hover, .profile-picture[_ngcontent-%COMP%]:hover {\\r\\n    opacity: 0.75;\\r\\n}\\r\\n\\r\\n.btn-primary[_ngcontent-%COMP%] {\\r\\n    background-color: var(--color-primary);\\r\\n    color: white;\\r\\n}\\r\\n\\r\\n.btn-success[_ngcontent-%COMP%] {\\r\\n    background-color: rgb(0, 175, 0);\\r\\n    color: white;\\r\\n}\\r\\n\\r\\n.profile-picture[_ngcontent-%COMP%] {\\r\\n    width: 2.7rem;\\r\\n    height: 2.7rem;\\r\\n    border-radius: 50%;\\r\\n    overflow: hidden;\\r\\n    cursor: pointer;\\r\\n    transition: all 300ms ease;\\r\\n}\\r\\n\\r\\n.btn[_ngcontent-%COMP%] {\\n  font-size: 0.9rem;\\n  padding: var(--btn-padding);\\n}\\r\\n\\r\\n.request[_ngcontent-%COMP%] {\\n  background-color: var(--color-white);\\n  padding: var(--card-padding);\\n  border-radius: var(--card-border-radius);\\n  margin-bottom: 0.7rem;\\n}\\r\\n\\r\\n.request[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%] {\\n  display: flex;\\n  gap: 1rem;\\n  margin-bottom: 1rem;\\n  align-items: center;\\n}\\r\\n\\r\\n.request[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%] {\\n  font-size: 1rem;\\n  font-weight: 500;\\n}\\r\\n\\r\\n.request[_ngcontent-%COMP%]   .action[_ngcontent-%COMP%] {\\n  display: flex;\\n  gap: 1rem;\\n}\\r\\n\\r\\n.request[_ngcontent-%COMP%]   .response[_ngcontent-%COMP%] {\\n  display: none;\\n  font-size: 1rem;\\n  font-weight: 500;\\n  text-align: center;\\n  color: var(--color-primary);\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3N0eWxlcy5zY3NzIiwicmVxdWVzdHMuY29tcG9uZW50LnNjc3MiLCIuLlxcLi5cXC4uXFwuLlxcLi5cXC4uXFwuLlxcQ29kZSUyMFBKXFxTb2NpYWxOZXR3b3JrV2ViQXBwXFxTb2NpYWxOZXR3b3JrV2ViQXBwLUZFXFxzcmNcXGFwcFxcY29tcG9uZW50c1xccmVxdWVzdHNcXHJlcXVlc3RzLmNvbXBvbmVudC5zY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBOzs7SUFHSSxTQUFTO0lBQ1QsVUFBVTtJQUNWLFVBQVU7SUFDVixzQkFBc0I7SUFDdEIscUJBQXFCO0lBQ3JCLGdCQUFnQjtJQUNoQixZQUFZOztJQUVaLG1EQUFtRDtBQUN2RDs7QUFFQTtJQUNJLGNBQWM7SUFDZCxXQUFXO0FBQ2Y7O0FBRUE7SUFDSSxxQkFBcUI7SUFDckIsMkJBQTJCO0lBQzNCLGdCQUFnQjtJQUNoQixtQ0FBbUM7SUFDbkMsZUFBZTtJQUNmLDBCQUEwQjtJQUMxQixpQkFBaUI7QUFDckI7O0FBRUE7O0lBRUksYUFBYTtBQUNqQjs7QUFFQTtJQUNJLHNDQUFzQztJQUN0QyxZQUFZO0FBQ2hCOztBQUVBO0lBQ0ksZ0NBQWdDO0lBQ2hDLFlBQVk7QUFDaEI7O0FBRUE7SUFDSSxhQUFhO0lBQ2IsY0FBYztJQUNkLGtCQUFrQjtJQUNsQixnQkFBZ0I7SUFDaEIsZUFBZTtJQUNmLDBCQUEwQjtBQUM5Qjs7QUNqREE7RUFDSSxpQkFBQTtFQUNBLDJCQUFBO0FDQUo7O0FER0E7RUFDSSxvQ0FBQTtFQUNBLDRCQUFBO0VBQ0Esd0NBQUE7RUFDQSxxQkFBQTtBQ0FKOztBREVJO0VBQ0ksYUFBQTtFQUNBLFNBQUE7RUFDQSxtQkFBQTtFQUNBLG1CQUFBO0FDQVI7O0FERVE7RUFDSSxlQUFBO0VBQ0EsZ0JBQUE7QUNBWjs7QURJSTtFQUNJLGFBQUE7RUFDQSxTQUFBO0FDRlI7O0FES0k7RUFDSSxhQUFBO0VBQ0EsZUFBQTtFQUNBLGdCQUFBO0VBQ0Esa0JBQUE7RUFDQSwyQkFBQTtBQ0hSIiwiZmlsZSI6InJlcXVlc3RzLmNvbXBvbmVudC5zY3NzIiwic291cmNlc0NvbnRlbnQiOlsiKixcclxuKjo6YmVmb3JlLFxyXG4qOjphZnRlciB7XHJcbiAgICBtYXJnaW46IDA7XHJcbiAgICBwYWRkaW5nOiAwO1xyXG4gICAgb3V0bGluZTogMDtcclxuICAgIGJveC1zaXppbmc6IGJvcmRlci1ib3g7XHJcbiAgICB0ZXh0LWRlY29yYXRpb246IG5vbmU7XHJcbiAgICBsaXN0LXN0eWxlOiBub25lO1xyXG4gICAgYm9yZGVyOiBub25lO1xyXG5cclxuICAgIGZvbnQtZmFtaWx5OiAnUm9ib3RvJywgc2Fucy1zZXJpZiwgQXJpYWwsIEhlbHZldGljYTtcclxufVxyXG5cclxuaW1nIHtcclxuICAgIGRpc3BsYXk6IGJsb2NrO1xyXG4gICAgd2lkdGg6IDEwMCU7XHJcbn1cclxuXHJcbi5idG4ge1xyXG4gICAgZGlzcGxheTogaW5saW5lLWJsb2NrO1xyXG4gICAgcGFkZGluZzogdmFyKC0tYnRuLXBhZGRpbmcpO1xyXG4gICAgZm9udC13ZWlnaHQ6IDUwMDtcclxuICAgIGJvcmRlci1yYWRpdXM6IHZhcigtLWJvcmRlci1yYWRpdXMpO1xyXG4gICAgY3Vyc29yOiBwb2ludGVyO1xyXG4gICAgdHJhbnNpdGlvbjogYWxsIDMwMG1zIGVhc2U7XHJcbiAgICBmb250LXNpemU6IDAuOXJlbTtcclxufVxyXG5cclxuLmJ0bjpob3ZlcixcclxuLnByb2ZpbGUtcGljdHVyZTpob3ZlciB7XHJcbiAgICBvcGFjaXR5OiAwLjc1O1xyXG59XHJcblxyXG4uYnRuLXByaW1hcnkge1xyXG4gICAgYmFja2dyb3VuZC1jb2xvcjogdmFyKC0tY29sb3ItcHJpbWFyeSk7XHJcbiAgICBjb2xvcjogd2hpdGU7XHJcbn1cclxuXHJcbi5idG4tc3VjY2VzcyB7XHJcbiAgICBiYWNrZ3JvdW5kLWNvbG9yOiByZ2IoMCwgMTc1LCAwKTtcclxuICAgIGNvbG9yOiB3aGl0ZTtcclxufVxyXG5cclxuLnByb2ZpbGUtcGljdHVyZSB7XHJcbiAgICB3aWR0aDogMi43cmVtO1xyXG4gICAgaGVpZ2h0OiAyLjdyZW07XHJcbiAgICBib3JkZXItcmFkaXVzOiA1MCU7XHJcbiAgICBvdmVyZmxvdzogaGlkZGVuO1xyXG4gICAgY3Vyc29yOiBwb2ludGVyO1xyXG4gICAgdHJhbnNpdGlvbjogYWxsIDMwMG1zIGVhc2U7XHJcbn0iLCJAaW1wb3J0IHVybCgnLi4vc3R5bGVzLnNjc3MnKTtcclxuXHJcbi5idG4ge1xyXG4gICAgZm9udC1zaXplOiAwLjlyZW07XHJcbiAgICBwYWRkaW5nOiB2YXIoLS1idG4tcGFkZGluZyk7XHJcbn1cclxuXHJcbi5yZXF1ZXN0IHtcclxuICAgIGJhY2tncm91bmQtY29sb3I6IHZhcigtLWNvbG9yLXdoaXRlKTtcclxuICAgIHBhZGRpbmc6IHZhcigtLWNhcmQtcGFkZGluZyk7XHJcbiAgICBib3JkZXItcmFkaXVzOiB2YXIoLS1jYXJkLWJvcmRlci1yYWRpdXMpO1xyXG4gICAgbWFyZ2luLWJvdHRvbTogMC43cmVtO1xyXG5cclxuICAgIC5pbmZvIHtcclxuICAgICAgICBkaXNwbGF5OiBmbGV4O1xyXG4gICAgICAgIGdhcDogMXJlbTtcclxuICAgICAgICBtYXJnaW4tYm90dG9tOiAxcmVtO1xyXG4gICAgICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7XHJcblxyXG4gICAgICAgIGg0IHtcclxuICAgICAgICAgICAgZm9udC1zaXplOiAxcmVtO1xyXG4gICAgICAgICAgICBmb250LXdlaWdodDogNTAwO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAuYWN0aW9uIHtcclxuICAgICAgICBkaXNwbGF5OiBmbGV4O1xyXG4gICAgICAgIGdhcDogMXJlbTtcclxuICAgIH1cclxuXHJcbiAgICAucmVzcG9uc2Uge1xyXG4gICAgICAgIGRpc3BsYXk6IG5vbmU7XHJcbiAgICAgICAgZm9udC1zaXplOiAxcmVtO1xyXG4gICAgICAgIGZvbnQtd2VpZ2h0OiA1MDA7XHJcbiAgICAgICAgdGV4dC1hbGlnbjogY2VudGVyO1xyXG4gICAgICAgIGNvbG9yOiB2YXIoLS1jb2xvci1wcmltYXJ5KTtcclxuICAgIH1cclxufSIsIkBpbXBvcnQgdXJsKFwiLi4vc3R5bGVzLnNjc3NcIik7XG4uYnRuIHtcbiAgZm9udC1zaXplOiAwLjlyZW07XG4gIHBhZGRpbmc6IHZhcigtLWJ0bi1wYWRkaW5nKTtcbn1cblxuLnJlcXVlc3Qge1xuICBiYWNrZ3JvdW5kLWNvbG9yOiB2YXIoLS1jb2xvci13aGl0ZSk7XG4gIHBhZGRpbmc6IHZhcigtLWNhcmQtcGFkZGluZyk7XG4gIGJvcmRlci1yYWRpdXM6IHZhcigtLWNhcmQtYm9yZGVyLXJhZGl1cyk7XG4gIG1hcmdpbi1ib3R0b206IDAuN3JlbTtcbn1cbi5yZXF1ZXN0IC5pbmZvIHtcbiAgZGlzcGxheTogZmxleDtcbiAgZ2FwOiAxcmVtO1xuICBtYXJnaW4tYm90dG9tOiAxcmVtO1xuICBhbGlnbi1pdGVtczogY2VudGVyO1xufVxuLnJlcXVlc3QgLmluZm8gaDQge1xuICBmb250LXNpemU6IDFyZW07XG4gIGZvbnQtd2VpZ2h0OiA1MDA7XG59XG4ucmVxdWVzdCAuYWN0aW9uIHtcbiAgZGlzcGxheTogZmxleDtcbiAgZ2FwOiAxcmVtO1xufVxuLnJlcXVlc3QgLnJlc3BvbnNlIHtcbiAgZGlzcGxheTogbm9uZTtcbiAgZm9udC1zaXplOiAxcmVtO1xuICBmb250LXdlaWdodDogNTAwO1xuICB0ZXh0LWFsaWduOiBjZW50ZXI7XG4gIGNvbG9yOiB2YXIoLS1jb2xvci1wcmltYXJ5KTtcbn0iXX0= */\"]\n});","map":{"version":3,"mappings":";AAEA,SAASA,aAAT,QAA8B,MAA9B;AACA,SAASC,QAAT,QAAyB,+BAAzB;AAEA,SAASC,IAAT,QAAqB,2BAArB;;;;;;;AAWA,OAAM,MAAOC,iBAAP,CAAwB;EAO5BC,YACUC,UADV,EAEUC,MAFV,EAGUC,WAHV,EAIUC,iBAJV,EAKUC,eALV,EAMUC,eANV,EAM0C;IALhC;IACA;IACA;IACA;IACA;IACA;IATV,YAAa,IAAIR,IAAJ,EAAb;IACA,gBAAmB,EAAnB;EASK;;EAELS,QAAQ;IACN,KAAKC,OAAL;EACD;;EAEDA,OAAO;IACL,KAAKL,WAAL,CAAiBM,OAAjB,CAAyB,KAAKC,cAAL,CAAoBC,MAA7C,EAAqDC,SAArD,CAA+DC,IAAI,IAAI,KAAKC,IAAL,GAAYD,IAAnF;EACD,CAtB2B,CAwB5B;EACA;EACA;EACA;;;EAEME,MAAM;IAAA;;IAAA;MACV,IAAI,KAAI,CAACL,cAAL,CAAoBM,MAApB,KAA+B,CAAnC,EAAsC;QACpC,KAAI,CAACN,cAAL,CAAoBM,MAApB,GAA6B,CAA7B;;QACA,KAAI,CAACZ,iBAAL,CAAuBa,MAAvB,CAA8B,KAAI,CAACP,cAAnC,EAAmDE,SAAnD,CAA6DC,IAAI,IAAI,KAAI,CAACK,YAAL,CAAkB,UAAlB,CAArE;;QAEA,IAAIC,QAAQ,GAAG,IAAItB,QAAJ,EAAf;QACAsB,QAAQ,CAACC,YAAT,GAAwB,EAAxB;QACAD,QAAQ,CAACE,EAAT,SAAoBzB,aAAa,CAAC,KAAI,CAACS,eAAL,CAAqBiB,GAArB,CAAyBH,QAAzB,CAAD,CAAjC;QAEAA,QAAQ,CAACI,WAAT,CAAqBC,IAArB,CAA0B,GAAG,CAAC,KAAI,CAACV,IAAN,EAAY,KAAI,CAACW,WAAjB,CAA7B;;QACA,KAAI,CAACpB,eAAL,CAAqBY,MAArB,CAA4BE,QAA5B,EAAsCP,SAAtC;MACD;IAXS;EAYX;;EAEDc,OAAO;IACL,KAAKtB,iBAAL,CAAuBuB,MAAvB,CAA8B,KAAKjB,cAAL,CAAoBW,EAAlD,EAAsDT,SAAtD,CAAgEgB,CAAC,IAAI,KAAKV,YAAL,CAAkB,UAAlB,CAArE;EACD;;EAEDA,YAAY,CAACW,MAAD,EAAe;IACzB,MAAMC,OAAO,GAAG,KAAK7B,UAAL,CAAgB8B,aAAhB,CAA8BC,aAA9B,CAA4C,SAA5C,CAAhB;IACA,MAAMC,WAAW,GAAG,KAAKhC,UAAL,CAAgB8B,aAAhB,CAA8BC,aAA9B,CAA4C,WAA5C,CAApB;IAEAF,OAAO,CAACI,KAAR,CAAcC,OAAd,GAAwB,MAAxB;IACAF,WAAW,CAACC,KAAZ,CAAkBC,OAAlB,GAA4B,OAA5B;IAEA,KAAKC,QAAL,GAAgBP,MAAhB;EACD;;EAEDQ,cAAc;IACZ,KAAKnC,MAAL,CAAYoC,aAAZ,CAA0B,aAAa,KAAK5B,cAAL,CAAoBC,MAAM,EAAjE;EACD;;AA3D2B;;;mBAAjBZ,mBAAiBwC;AAAA;;;QAAjBxC;EAAiByC;EAAAC;IAAA/B;IAAAe;EAAA;EAAAiB;EAAAC;EAAAC;EAAAC;IAAA;MChB9BN,+BAAqB,CAArB,EAAqB,KAArB,EAAqB,CAArB,EAAqB,CAArB,EAAqB,KAArB,EAAqB,CAArB,EAAqB,CAArB,EAAqB,KAArB,EAAqB,CAArB;MAGiBA;QAAA,OAASO,oBAAT;MAAyB,CAAzB,EAA0B,OAA1B,EAA0B;QAAA,OAAwCA,2BAAxC;MAAoE,CAA9F;MAALP;MAEJA,4BAAK,CAAL,EAAK,IAAL;MACQA;MAA2BA;MAC/BA;MACIA;MACJA;MAGRA,+BAAoB,EAApB,EAAoB,QAApB,EAAoB,CAApB;MACoCA;QAAA,OAASO,YAAT;MAAiB,CAAjB;MAC5BP;MACJA;MACAA;MAAoBA;QAAA,OAASO,aAAT;MAAkB,CAAlB;MAChBP;MACJA;MAEJA;MACIA;MACJA;;;;MAnBwCA;MAAAA;MAG5BA;MAAAA;MAEAA;MAAAA;MAaRA;MAAAA","names":["lastValueFrom","Chatroom","User","RequestsComponent","constructor","elementRef","router","userService","friendshipService","chatroomService","chattingService","ngOnInit","getUser","getById","friendshipData","userId","subscribe","data","user","accept","status","update","showResponse","chatroom","chatroomName","id","add","chatMembers","push","currentUser","decline","delete","_","result","buttons","nativeElement","querySelector","responseElm","style","display","response","navigateToWall","navigateByUrl","i0","selectors","inputs","decls","vars","consts","template","ctx"],"sourceRoot":"","sources":["D:\\Code PJ\\SocialNetworkWebApp\\SocialNetworkWebApp-FE\\src\\app\\components\\requests\\requests.component.ts","D:\\Code PJ\\SocialNetworkWebApp\\SocialNetworkWebApp-FE\\src\\app\\components\\requests\\requests.component.html"],"sourcesContent":["import { Component, ElementRef, EventEmitter, Input, OnInit, Output } from '@angular/core';\r\nimport { Router } from '@angular/router';\r\nimport { lastValueFrom } from 'rxjs';\r\nimport { Chatroom } from 'src/app/models/chatroom.model';\r\nimport { Friendship } from 'src/app/models/friendship.model';\r\nimport { User } from 'src/app/models/user.model';\r\nimport { ChatroomService } from 'src/app/services/chatroom.service';\r\nimport { ChattingService } from 'src/app/services/chatting.service';\r\nimport { FriendshipService } from 'src/app/services/friendship.service';\r\nimport { UserService } from 'src/app/services/user.service';\r\n\r\n@Component({\r\n  selector: 'app-requests',\r\n  templateUrl: './requests.component.html',\r\n  styleUrls: ['./requests.component.scss']\r\n})\r\nexport class RequestsComponent implements OnInit {\r\n  @Input() friendshipData!: Friendship;\r\n  @Input() currentUser!: User;\r\n\r\n  user: User = new User();\r\n  response: string = '';\r\n\r\n  constructor(\r\n    private elementRef: ElementRef,\r\n    private router: Router,\r\n    private userService: UserService,\r\n    private friendshipService: FriendshipService,\r\n    private chatroomService: ChatroomService,\r\n    private chattingService: ChattingService\r\n  ) { }\r\n\r\n  ngOnInit(): void {\r\n    this.getUser();\r\n  }\r\n\r\n  getUser(): void {\r\n    this.userService.getById(this.friendshipData.userId).subscribe(data => this.user = data);\r\n  }\r\n\r\n  // accept(): void {\r\n  //   this.friendshipData.status = 1;\r\n  //   this.friendshipService.update(this.friendshipData).subscribe(_ => this.showResponse('accepted'));\r\n  // }\r\n\r\n  async accept(): Promise<void> {\r\n    if (this.friendshipData.status === 0) {\r\n      this.friendshipData.status = 1;\r\n      this.friendshipService.update(this.friendshipData).subscribe(data => this.showResponse('accepted'));\r\n\r\n      let chatroom = new Chatroom();\r\n      chatroom.chatroomName = '';\r\n      chatroom.id = await lastValueFrom(this.chatroomService.add(chatroom));\r\n\r\n      chatroom.chatMembers.push(...[this.user, this.currentUser]);\r\n      this.chatroomService.update(chatroom).subscribe();\r\n    }\r\n  }\r\n\r\n  decline(): void {\r\n    this.friendshipService.delete(this.friendshipData.id).subscribe(_ => this.showResponse('declined'));\r\n  }\r\n\r\n  showResponse(result: string): void {\r\n    const buttons = this.elementRef.nativeElement.querySelector('.action') as HTMLElement;\r\n    const responseElm = this.elementRef.nativeElement.querySelector('.response') as HTMLElement;\r\n\r\n    buttons.style.display = 'none';\r\n    responseElm.style.display = 'block';\r\n\r\n    this.response = result;\r\n  }\r\n\r\n  navigateToWall(): void {\r\n    this.router.navigateByUrl(`home/wall/${this.friendshipData.userId}`);\r\n  }\r\n}\r\n","<div class=\"request\">\r\n    <div class=\"info\">\r\n        <div class=\"profile-picture\">\r\n            <img (click)=\"navigateToWall()\" [src]=\"this.user.getAvatar()\" (error)=\"this.user.getDefaultAvatar()\" alt=\"\">\r\n        </div>\r\n        <div>\r\n            <h4>{{this.user.getFullName()}}</h4>\r\n            <p class=\"text-muted\">\r\n                @{{this.user.getEmailPrefix()}}\r\n            </p>\r\n        </div>\r\n    </div>\r\n    <div class=\"action\">\r\n        <button class=\"btn btn-primary\" (click)=\"accept()\">\r\n            Accept\r\n        </button>\r\n        <button class=\"btn\" (click)=\"decline()\">\r\n            Decline\r\n        </button>\r\n    </div>\r\n    <div class=\"response\">\r\n        Request has been {{this.response}}\r\n    </div>\r\n</div>"]},"metadata":{},"sourceType":"module"}